#!/usr/bin/env python

import scanner

#target_url = "http://192.168.30.137/mutillidae/"
target_url = "http://192.168.30.137/dvwa/"
links_to_ignore = ["http://192.168.30.137/dvwa/logout.php"] # We must avoid the scanner to logout right after login in
data_dict = {"username": "admin", "password": "password", "Login": "submit"}

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://192.168.30.137/dvwa/login.php", data=data_dict)
vuln_scanner.crawl()
vuln_scanner.run_scanner()
forms = vuln_scanner.extract_forms("http://192.168.30.137/dvwa/vulnerabilities/xss_r/")
# print(forms)

# response = vuln_scanner.submit_form(forms[0], "testtest", "http://192.168.30.137/dvwa/vulnerabilities/xss_r/")
# print(response.content)

response = vuln_scanner.test_xss_in_form(forms[0], "http://192.168.30.137/dvwa/vulnerabilities/xss_r/")
print(response)

# response = vuln_scanner.test_xss_in_link("http://192.168.30.137/dvwa/vulnerabilities/xss_r/?name=test")
# response = vuln_scanner.test_xss_in_link("http://192.168.30.137/dvwa/vulnerabilities/fi/?page=include.php")
print(response)